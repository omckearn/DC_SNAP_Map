<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>DC SNAP Retailers</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- Favicons -->
  <link rel="apple-touch-icon" sizes="180x180" href="img/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="img/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="img/favicon-16x16.png">
  <link rel="icon" href="img/favicon.ico">
  <link rel="manifest" href="img/site.webmanifest">
  <meta name="theme-color" content="#033C5A">
  <link href="style.css" rel="stylesheet" />
  <script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>
  <link href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css" rel="stylesheet" />
</head>
<body>
  <header id="siteHeader" class="site-header">DC SNAP Retailers Locator Map</header>
  <div id="filters">
    <div class="panel-title">Filter <button id="filtersToggle" class="panel-toggle" type="button">Hide</button></div>
    <div class="filter-group">
      <div class="filter-title">Store Types</div>
      <div id="storeTypeFilters" class="checkbox-group"></div>
    </div>

    <div class="filter-group">
      <div class="filter-title">Aggregation</div>
      <label><input id="aggToggle" type="checkbox" /> Aggregate points (clusters)</label>
    </div>

  
    <div class="filter-group">
      <div class="filter-title">Navigation</div>
      <button id="clearFilters" type="button">Clear</button>
      <button id="homeView" type="button">Home</button>
      <button id="toggleBorderRetailers" type="button">Show SNAP retailers in bordering counties</button>
    </div>

    <div class="filter-group">
      <div class="filter-title">Ward</div>
      <div id="wardDropdown" class="dropdown">
        <button id="wardDropdownBtn" type="button" aria-haspopup="listbox" aria-expanded="false">All Wards ▾</button>
        <div id="wardDropdownPanel" class="dropdown-panel" role="listbox"></div>
      </div>
    </div>

    <div id="countyFilterGroup" class="filter-group" style="display:none;">
      <div class="filter-title">Counties</div>
      <div id="countyDropdown" class="dropdown">
        <button id="countyDropdownBtn" type="button" aria-haspopup="listbox" aria-expanded="false">All Counties ▾</button>
        <div id="countyDropdownPanel" class="dropdown-panel" role="listbox"></div>
      </div>
    </div>
  </div>

  <!-- Dock for Mapbox nav controls placed just below filters -->
  <div id="mapNavDock" class="map-nav-dock"></div>

  <!-- Near Me Panel -->
  <div id="near-panel" class="near-panel">
    <div class="near-title">SNAP Retailers Near Me <button id="nearToggle" class="panel-toggle" type="button">Hide</button></div>
    <div class="near-inputs">
      <input id="nearAddress" type="text" placeholder="Enter address in DC" />
      <button id="nearSearch" type="button">Search</button>
      <button id="nearUseGeo" type="button">Use my location</button>
      <button id="nearPick" type="button">Pick on map</button>
      <button id="nearUseCenter" type="button">Use map center</button>
      <select id="unitsSelect" title="Distance units">
        <option value="miles" selected>Miles</option>
        <option value="kilometers">Kilometers</option>
      </select>
    </div>
    <div id="nearHint" class="near-hint" style="display:none">Click on the map to set a location</div>
    <div id="nearList" class="near-list"></div>
  </div>

  <div id="map"></div>

  <!-- Legend overlay -->
  <div id="legend" class="legend"></div>

  <!-- Data source attribution -->
  <div id="data-attrib" class="data-attrib">
    Data source: <a href="https://usda-snap-retailers-usda-fns.hub.arcgis.com/datasets/8b260f9a10b0459aa441ad8588c2251c/explore?location=6.440261%2C-14.737150%2C2.90" target="_blank" rel="noopener">USDA SNAP Retailers</a> Sep 17, 2025
  </div>

  <!-- Intro modal for new users -->
  <div id="introModal" class="modal-overlay" style="display:none;">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Welcome to DC SNAP Retailers</h3>
        <button id="introClose" class="modal-close" aria-label="Close">×</button>
      </div>
      <div class="modal-body">
        <p><strong>Welcome!</strong></p>
        <p>This map helps you find stores in Washington, DC that accept SNAP benefits.</p>
        <ul>
          <li>&ldquo;Each dot on the map shows a store. Different colors and icons mean different types of stores.&rdquo;</li>
          <li>&ldquo;You can zoom in, move around, and click on a dot to see the store’s name, address, and a button for directions.&rdquo;</li>
          <li>&ldquo;Use the filters on the left to show only certain store types or wards.&rdquo;</li>
          <li>&ldquo;The &ldquo;Near Me&rdquo; box on the right lets you type an address, use your location, or pick a spot on the map to see which stores are closest.&rdquo;</li>
          <li>&ldquo;The legend at the bottom explains what the colors and numbers mean.&rdquo;</li>
        </ul>
        <p>This tool is meant to make it easy for anyone to find SNAP‑accepting stores near them.</p>
      </div>
      <div class="modal-actions">
        <label><input type="checkbox" id="introDontShow" /> Don’t show this again</label>
        <button id="introGotIt" class="modal-primary">Got it</button>
      </div>
    </div>
  </div>

  <!-- Load untracked config.js with MAPBOX token before app.js -->
  <script src="config.js"></script>
  <!-- Turf.js for point-in-polygon (ward filtering) -->
  <script src="https://cdn.jsdelivr.net/npm/@turf/turf@6/turf.min.js"></script>
  <script src="app.js"></script>
</body>
</html>
